"use strict";(self.legacyJsonp=self.legacyJsonp||[]).push([["8419"],{507203:function(e,t,n){n.r(t);var o={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"CloseupCommentButton_pin",selections:[{alias:null,args:null,kind:"ScalarField",name:"isEligibleForPdp",storageKey:null},{args:null,kind:"FragmentSpread",name:"CommentsPopover_pin"}],type:"Pin",abstractKey:null};o.hash="069f535669d5c7a5922989e3b70f35f7",t.default=o},20262:function(e,t,n){n.r(t),n.d(t,{default:function(){return C}});var o,r=n(586659);n(872555);var i=n(20256),l=n(934645),a=n(980787),s=n(415546),c=n(709311),u=n(525839),d=n(941404),m=n(601686),f=n(230543),p=n(78762),v=n(382718);function h(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=Array(t);n<t;n++)o[n]=e[n];return o}var g=(0,p.Z)(function(){return n.e("30233").then(n.bind(n,210238))},void 0,function(e){return 210238},"CommentsPopover",function(e){return ["30233"]}),y=(void 0!==o||(o=n(507203)).hash&&"069f535669d5c7a5922989e3b70f35f7"!==o.hash&&console.error("The definition of 'CloseupCommentButton_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),o);function C(e){var t,n=e.inCommentsImprovedDropdownExp,o=e.inCommentsPopoverExp,p=e.isEligibleForAggregatedComments,C=e.pinKey,b=e.shouldShowCommentCount,w=e.totalCommentCount,x=e.viewParameter,_=e.viewType,E=e.scrollContainerRef,P=(0,u.ZP)(),I=(0,f.t)(),T=(0,s.Z)(y,C),j=(0,l.Z)({showProductDetailPage:!!T.isEligibleForPdp}),S=(0,m.x4)(),R=S.isCommentThreadExpanded,A=S.setIsCommentThreadExpanded,B=S.setIsCommentComposerFocused,k=(0,a.u)().logContextEvent,F=(0,r.useRef)(null),L=function(e){if(Array.isArray(e))return e}(t=(0,r.useState)(!1))||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var o,r,i,l,a=[],s=!0,c=!1;try{for(i=(n=n.call(e)).next;!(s=(o=i.call(n)).done)&&(a.push(o.value),2!==a.length);s=!0);}catch(e){c=!0,r=e}finally{try{if(!s&&null!=n.return&&(l=n.return(),Object(l)!==l))return}finally{if(c)throw r}}return a}}(t,2)||function(e,t){if(e){if("string"==typeof e)return h(e,2);var n=({}).toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?h(e,2):void 0}}(t,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),D=L[0],Z=L[1],z=o&&R;(0,r.useEffect)(function(){if(j&&E){var e=document.getElementById("canonical-card");if(e){var t=new IntersectionObserver(function(e){var t=e[0];t&&Z(t.isIntersecting)},{root:E,threshold:0});return t.observe(e),setTimeout(function(){var n=t.takeRecords();if(n.length>0&&n[0])Z(n[0].isIntersecting);else{var o=E.getBoundingClientRect(),r=e.getBoundingClientRect();Z(r.top>=o.top&&r.top<=o.bottom)}},100),function(){t.disconnect()}}}},[j,E]);var K=P.bt("Comentarios", "Comments", "Closeup.Comment.Icon", undefined, true),O=function(e){k({component:13464,element:2,event_type:10554,view_parameter:x,view_type:_}),(0,d.tj)("dweb.closeup_comment_button.community_view_intent",{tags:{experimentGroup:n?"improved_dropdown":"popover",clickSource:e}})},J=function(e){var t=document.getElementById("canonical-card"),o=document.querySelector('[data-test-id="canonical-card-tap-area"]');if(t){if(j&&E){var r=E.getBoundingClientRect(),i=t.getBoundingClientRect().top-r.top,l=E.scrollTop+i-I,a=null,s=function t(){a&&clearTimeout(a),a=setTimeout(function(){n&&(null==A||A(!0),O(e)),o&&o.focus(),E.removeEventListener("scroll",t)},100)};E.addEventListener("scroll",s,{passive:!0}),s(),E.scrollTo({top:l,behavior:"smooth"});return}var c=t.getBoundingClientRect().top+window.scrollY-I,u=null,d=function t(){u&&clearTimeout(u),u=setTimeout(function(){n&&(null==A||A(!0),O(e)),o&&o.focus(),window.removeEventListener("scroll",t)},100)};window.addEventListener("scroll",d,{passive:!0}),d(),window.scrollTo({top:c,behavior:"smooth"})}},M=function(e){if(o)R?null==A||A(!1):(null==A||A(!0),O(e));else if(j){var t=w>0;R||!t||null==A||A(!0),O(e),B(!0)}else J(e)};return(0,v.jsxs)(i.xu,{children:[z&&(0,v.jsx)(g,{anchorRef:F,pinKey:T,setIsOpen:A,viewParameter:x}),(0,v.jsxs)(i.kC,{alignItems:"center",direction:"row",children:[(0,v.jsx)(i.hU,{ref:F,accessibilityLabel:K,disabled:!p,icon:"speech-outline",onClick:function(){return M("icon")},selected:z,size:"lg",tooltip:{text:K}}),b&&(0,v.jsx)(i.iP,{disabled:!p||j&&D,onTap:function(){return M("count")},children:(0,v.jsx)(i.xv,{weight:"bold",children:(0,v.jsx)(c.Z,{shortform:!0,shortformMaximumFractionDigits:1,value:w})})})]})]})}}}]);